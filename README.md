## Population mortality in Sudan, 2023-2024: A capture-recapture analysis
### Description of input dataset and R analysis scripts
September 2024

## General description
This repository contains data and R scripts needed to replicate the above analysis. The single dataset required is found in the `\in` folder, and is read automatically when the code is run. Every row in the dataset contains an individual record of a deceased person, as contained in one of three independent lists generated by the study. The Excel file also contains a variable dictionary. All the code is found in the `\code` folder. To replicate the analysis, follow these steps:
* Download and unzip the repository to any folder in your computer (other than the Downloads folder, which usually gets wiped automatically). The folder is identified automatically when the code is run.
* Download R and RStudio (see download links on [https://posit.co/download/rstudio-desktop/]). While R is sufficient to run the analysis, it is recommended to instead run the scripts from the RStudio interface.
* Run the entire `00_master_code.R` script. This will create an `\out` folder with further sub-folders, to which output tables and graphs will be saved automatically. As this scripts calls all the others, it alone is sufficient to replicate the analysis. On a cheap laptop, it should take about max. 5-10 minutes to run the analysis.

## Description of each R script
* `00_master_code.R` installs or loads R packages needed for this analysis, sets general parameters and sources the other scripts in logical order.
* `01_functions.R` contains functions needed for different steps in the analysis.
* `02_read_prepare_data.R` carries out several data cleaning and management tasks, de-duplicates records within each list based on a given duplication score (confidence) threshold, and lastly matches records across lists based on a given match (overlap) confidence score threshold. A clean, analysis-ready dataset is generated for each combination of duplication threshold ('d') and match (overlap) threshold ('o'), and saved in the corresponding `\d[i]o[j]` folder, where i = 1 to 5 and j = 1 to 5, namely the possible levels of the two thresholds.
* `03_describe_data.R` generates various descriptive analyses for each d[i]o[j] dataset, including attrition, characteristics of each list, numbers listed by date, matching deaths by cause and the overlap of deaths. All outputs are saved to each respective `\d[i]o[j]` folder.
* `04_estimate_mortality.R` performs capture-recapture estimation for deaths within Khartoum State only (other states feature too much data sparsity), by cause (all causes and intentional injuries only). All possible log-linear models are fitted to the three-list matching structure of the dataset, confounders are added to the model and lastly the alternative models are averaged using their goodness-of-fit as a weight, yielding estimates of the unlisted and total number of deaths, with confidence intervals, by model and overall. Results are saved in different .csv files, where the 'raw' version contains more information, and the 'pretty' version is meant for publication. The sensitivity of each list is also estimated. Again, all outputs are stored in each `\d[i]o[j]` folder. However, tables and graphs summarising all the different sensitivity analyses ('d', 'o' combinations) are also generated: these are stored in the `\out` folder.

